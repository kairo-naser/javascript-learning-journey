<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Fetch API snd HTTP methods</title>
</head>
<body>
    

    <h3>API</h3>
    <p id="text"></p>

    <form id="form" method="post">
        <h3>Added some test post in this fake api</h3>
        <input type="text" id="id"> <br>
        <input type="text" id="title"> <br>
        <textarea id="body">  </textarea><br>
        <button id="btn" type="submit">Add</button>
    </form>

    <p id="newPost"></p>

    <script>
        const text = document.getElementById("text")

        //fetching data from fake api using get function
        async function fetchData(){
            try{
                const response = await fetch ("https://jsonplaceholder.typicode.com/posts")
                const posts = await response.json()
                //text.innerHTML = posts
                text.innerHTML = JSON.stringify(posts.slice(0,5), null , 2 )

            }

            catch(error){
               text.innerHTML = error
            }

            finally{
                console.log("This is the finall text, ended")
            }
        }

        fetchData()


        //posting data to fake api using post function
        
        const form = document.getElementById("form")
       
        const newPost = document.getElementById("newPost")
        form.addEventListener("submit", (event)=>{
            event.preventDefault()
             const id = document.getElementById("id").value
        const title = document.getElementById("title").value
        const body = document.getElementById("body"). value
        
            async function addData(){
                try{
                    const response = await fetch("https://jsonplaceholder.typicode.com/posts",{
                        method :"POST",
                        headers:{
                            'Content-type':'application/json'
                        },
                        body:JSON.stringify({
                          title : title,
                          body:body,
                          userId:id
                        })
                    })
                    const postData = await response.json()
                    console.log("Added new post:: ", postData)
                    //corrct way to concatenation in html strings is + 
                    newPost.innerHTML = "Post created:: "+  JSON.stringify(postData, null , 2)
                }
                 catch (error){
                newPost.innerHTML ="Error: ", error
            }
            finally{
                console.log("Ended")
            }
            }
             addData()
        }
        
        )

      

    </script>
</body>
</html>